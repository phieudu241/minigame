var óãæ=new Class({initialize:function(){this.ï=[];this.êá=0;this.æá=0;},âàÇ:function(Ý){if(!$defined(Ý)){return;}this.ï[this.æá]=Ý;this.æá++;},Ù:function(){if(this.êá==this.æá){return null;}var ÔÞ=this.ï[this.êá];this.ï[this.êá]=null;this.êá++;return ÔÞ;},clear:function(){this.ÐÝë=[];this.êá=0;this.æá=0;},ËÝó:function(){if(this.êá==this.æá){return null;}return this.ï[this.êá];},Ç:function(){return this.æá-this.êá;},contains:function(ÃÛ){for(var i=this.êá;i<this.æá;i++){if(this.ï[i]==ÃÛ){return true;}}return false;},empty:function(){}});var µÛ=new Class({initialize:function(ýÚÔ){this.ÐÝë=[];this.ù=0;if(ýÚÔ!=null){this.ô(ýÚÔ);}},ô:function(ïØ){if(ïØ==null){return;}this.ù+=ïØ.length;this.ÐÝë.push(ïØ)},clear:function(){this.ÐÝë=[];this.ù=0;},length:function(){return this.ù;},toString:function(){return this.ÐÝë.join("");},empty:function(){;}});var ëØù=new(new Class({initialize:function(){this.çÖº=new Date();this.log("start.");},log:function(ã){var ÞÕ=new Date();var ÚÔ=(ÞÕ-this.çÖº)/1000;this.çÖº=ÞÕ;if(window.console&&console.log){console.log(ÚÔ+"\t"+ã);}else{}}}))();var ÕÓã=new Class({initialize:function(){this.Ð=1;this.àµÀ=0;this.Ü=null;this.Ø=100;this.Òÿ=0;this.Îÿä='gameCell_';this.Êþí=[];this.Æ=[];window.addEvent('domready',this.Áý.bind(this));},Áý:function(){$('start').addEvent('click',this.ªü.bindWithEvent(this));$('stop').addEvent('click',this.üûÎ.bindWithEvent(this));$('pause').addEvent('click',this.ö.bindWithEvent(this));$('level').addEvent('change',this.ò.bindWithEvent(this));document.addEvent('contextmenu',this.îù.bindWithEvent(this));document.addEvent('keydown',this.êùò.bindWithEvent(this));this.åøü();},êùò:function(á){á.stop();switch(á.key){case'enter':if(this.Ýö()!=Ùõ.ÓõÝ){this.Ï();}else{this.Ë();}break;case'esc':this.Æó();break;}this.Âòµ(á.key);},îù:function(á){á.stop();if(this.Ýö()==Ùõ.ÓõÝ){this.µ(á);}},ý:function(status){this.àµÀ=this.Ð;this.Ð=status;},Ýö:function(){return this.Ð;},ªü:function(øð){øð.stop();$('start').blur();if(this.Ð==Ùõ.ÓõÝ||this.Ð==Ùõ.óïâ){return;}this.Ï();},Ï:function(){if(this.Ð!=Ùõ.ÓõÝ){this.ý(Ùõ.ÓõÝ);this.ïïê();}},üûÎ:function(øð){øð.stop();$('stop').blur();this.Æó();},Æó:function(){if(this.Ð==Ùõ.ê){return;}if(this.Ð!=Ùõ.ê){this.ý(Ùõ.ê);this.ïïê();}},ö:function(øð){øð.stop();$('pause').blur();if(this.Ð==Ùõ.ê){return;}if(this.Ð==Ùõ.óïâ){this.Ï();}else if(this.Ð==Ùõ.ÓõÝ){this.Ë();}},Ë:function(){if(this.Ð!=Ùõ.óïâ){this.ý(Ùõ.óïâ);this.ïïê();}},ò:function(){$('level').blur();this.æí($('level').value.toInt());},ïïê:function(){if(this.Ð==Ùõ.ê){this.âí();this.ÞìË();$('start').removeClass('disabled');$('start').addClass('positive');$('pause').addClass('disabled');$('stop').removeClass('negative');$('stop').addClass('disabled');this.Ô();this.Ðê('-');}else if(this.Ð==Ùõ.ÓõÝ){this.Ëéï();this.Çéù();$('start').removeClass('positive');$('start').addClass('disabled');$('pause').removeClass('disabled');$('stop').removeClass('disabled');$('stop').addClass('negative');if(this.àµÀ==Ùõ.óïâ){$('pause').innerHTML="暂停游戏";}else{this.Ðê(0);}this.Ã();}else if(this.Ð==Ùõ.óïâ){this.Ëéï();this.Çéù();$('start').removeClass('positive');$('start').addClass('disabled');$('pause').removeClass('disabled');if(this.àµÀ==Ùõ.ÓõÝ){$('pause').innerHTML="继续游戏";}this.ºç();}this.ýç(this.Ð,this.àµÀ);},Ã:function(){this.Ü=this.ùæÚ.periodical(this.Ø,this);},Ô:function(){this.Òÿ=0;$clear(this.Ü);},ºç:function(){$clear(this.Ü);},ùæÚ:function(){this.Òÿ+=this.Ø;if(this.Òÿ%1000==0){this.Ðê(this.Òÿ/1000);}this.ð(this.Ø);},Ðê:function(ëä){$('elapsedTime').innerHTML=this.çãþ(ëä);},çãþ:function(Ì){if(Ì=='-'){return'-';}if(Ì==0){return"0秒";}var È="";if(Ì>=3600){var ÄÞ=Math.floor(Ì/3600);Ì=Ì-ÄÞ*3600;È+=ÄÞ+"时";}if(Ì>=60){var ºÞÉ=Math.floor(Ì/60);Ì=Ì-ºÞÉ*60;È+=ºÞÉ+"分";}if(Ì!=0){È+=Ì+"秒";}return È;},Ëéï:function(){$('leftzhuangtai').removeClass('gray');},âí:function(){$('leftzhuangtai').addClass('gray');},ÞìË:function(){var þÝÑ=$('leftshezhi').getChildren();þÝÑ.each(function(ú,index){ú.disabled=false;});},Çéù:function(){var þÝÑ=$('leftshezhi').getChildren();þÝÑ.each(function(ú,index){ú.disabled=true;});},õÜ:function(ðÛ){},ýç:function(ìÚõ,è){;},ð:function(ä){;},åøü:function(){;},µ:function(á){;},Âòµ:function(key){;},ßØ:function(ÛØÖ){var ÖÖà=[];var Ñ=ÛØÖ.substr(this.Îÿä.length);var ÍÕ=Ñ.lastIndexOf('_');ÖÖà[0]=Ñ.substr(0,ÍÕ).toInt();ÖÖà[1]=Ñ.substr(ÍÕ+1).toInt();return ÖÖà;},ÉÔ:function(ÅÓÁ,À){return this.Îÿä+ÅÓÁ+'_'+À;},Ïµá:function(ÅÓÁ,À){return $(this.ÉÔ(ÅÓÁ,À));},Âÿ:function(value){if(!$defined(value)){value=null;}this.Êþí=[];for(var i=0;i<this.µÿÂ;i++){this.Êþí[i]=[];for(var ýþË=0;ýþË<this.ø;ýþË++){this.Êþí[i][ýþË]=value;}}},óý:function(value){for(var i=0;i<this.µÿÂ;i++){for(var ýþË=0;ýþË<this.ø;ýþË++){if(!$defined(this.Êþí[i][ýþË])){this.Êþí[i][ýþË]=value;}}}},ïü:function(){var ÅÓÁ=$random(0,this.µÿÂ-1);var À=$random(0,this.ø-1);for(;ÅÓÁ<this.µÿÂ;ÅÓÁ++){for(;À<this.ø;À++){var ëüï=this.Êþí[ÅÓÁ][À];if(!$defined(ëüï)){return[ÅÓÁ,À];}}}for(ÅÓÁ=0;ÅÓÁ<this.µÿÂ;ÅÓÁ++){for(À=0;À<this.ø;À++){var ëüï=this.Êþí[ÅÓÁ][À];if(!$defined(ëüï)){return[ÅÓÁ,À];}}}return null;},æ:function(value){var ÖÖà=this.ïü();if(ÖÖà!==null){this.Êþí[ÖÖà[0]][ÖÖà[1]]=value;}},â:function(Þú,ÚùÐ){if(Þú<0||Þú>=this.µÿÂ||ÚùÐ<0||ÚùÐ>=this.ø){return true;}return false;},ÔøÚ:function(value){for(var i=0;i<this.µÿÂ;i++){for(var ýþË=0;ýþË<this.ø;ýþË++){if(this.Êþí[i][ýþË]&&this.Êþí[i][ýþË]==value){return true;}}}return false;},Ìö:function(){var Çõ=Ãõý.º;var þ=$random(0,3);switch(þ){case 0:Çõ=Ãõý.º;break;case 1:Çõ=Ãõý.ùó;break;case 2:Çõ=Ãõý.ôòÞ;break;case 3:Çõ=Ãõý.ðñç;break;}return Çõ;},ë:function(direction){var Çõ=Ãõý.º;switch(direction){case Ãõý.ðñç:Çõ=Ãõý.º;break;case Ãõý.º:Çõ=Ãõý.ùó;break;case Ãõý.ùó:Çõ=Ãõý.ôòÞ;break;case Ãõý.ôòÞ:Çõ=Ãõý.ðñç;break;}return Çõ;},çð:function(ã){alert(ã);this.Æó();},empty:function(){;}});var Ùõ={ê:1,ÓõÝ:2,óïâ:3};var ãïº={ßïÈ:1,Ú:2,Õí:3,Ñí:4,Íìì:5};var Ãõý={º:1,ùó:2,ôòÞ:3,ðñç:4};var ÝÝÐ=ÕÓã.extend({initialize:function(){this.parent();},åøü:function(){this.µÿÂ=0;this.ø=0;this.Ûä=0;this.ÓÜ=0;this.ÏÛ=34;this.ËÚô=0;this.Â=null;this.µØ=null;this.ýØÕ();this.Í();$('xipai').addEvent('click',this.ùÖÞ.bindWithEvent(this));},ýç:function(ìÚõ,è){if(ìÚõ==Ùõ.ê){$('leftCount').innerHTML="-";$('xipaiCount').innerHTML='-';$('xipai').addClass('disabled');this.Í();}else if(ìÚõ==Ùõ.ÓõÝ){if(è!=Ùõ.óïâ){this.ó();$('leftCount').innerHTML=this.ÓÜ/2+"对";$('xipaiCount').innerHTML=this.ËÚô+'次';$('xipai').removeClass('disabled');}else{$('xipai').removeClass('disabled');}}else if(ìÚõ==Ùõ.óïâ){$('xipai').addClass('disabled');}},ð:function(Éâ){},µ:function(á){if(this.Â){this.ïÕ();}},Âòµ:function(key){switch(key){case'down':break;}},æí:function(Åá){this.Í(Åá);},Í:function(Åá){if(!Åá){Åá=$('level').value.toInt();}else{$('level').value=Åá;}switch(Åá){case ãïº.ßïÈ:this.µÿÂ=4;this.ø=6;break;case ãïº.Ú:this.µÿÂ=5;this.ø=8;break;case ãïº.Õí:this.µÿÂ=6;this.ø=9;break;case ãïº.Ñí:this.µÿÂ=7;this.ø=10;break;case ãïº.Íìì:this.µÿÂ=8;this.ø=12;break;}this.Ûä=this.µÿÂ*this.ø;this.ÓÜ=this.Ûä;this.ËÚô=0;this.Âÿ();this.ëÔ(Åá);this.ÁàÅ();},ýØÕ:function(){var æÓº=[];var Þ=this.ÏÛ+1;for(var i=0;i<Þ;i++){æÓº[i]=new Image();æÓº[i].src="./img/1/"+i+".gif";æÓº[i+Þ]=new Image();æÓº[i+Þ].src="./img/1/"+i+"_over.gif";}},ëÔ:function(Åá){var í={};var äª=this.Ûä/2;for(var i=0;i<äª;i++){var àÿÁ=Math.floor((this.ÏÛ+1)*(Åá/ãïº.Íìì));var ÜþÉ=-1;do{ÜþÉ=$random(1,àÿÁ-1);}while(this.Ö3(í,ÜþÉ));this.æ(ÜþÉ);this.æ(ÜþÉ);}},Ö3:function(í,ÜþÉ){var Òý=í[ÜþÉ];if(!$defined(Òý)){í[ÜþÉ]=1;return false;}else{if(Òý>=3){return true;}else{í[ÜþÉ]+=1;return false;}}},ÁàÅ:function(){var ÿ=new µÛ();ÿ.ô('<table id="gameTable" cellspacing="0" cellpadding="0" border="0"');for(var i=0;i<this.µÿÂ;i++){ÿ.ô('<tr>');for(var ýþË=0;ýþË<this.ø;ýþË++){ÿ.ô('<td id="'+this.ÉÔ(i,ýþË)+'">');ÿ.ô('<img class="bottom" src="./img/1/0.gif" />');ÿ.ô('</td>');}ÿ.ô('</tr>');}ÿ.ô('</table>');$('main').innerHTML=ÿ.toString();$('gameTable').addEvent('click',this.û.bindWithEvent(this));$('gameTable').addEvent('selectstart',this.öÞ.bindWithEvent(this));},öÞ:function(á){á.stop();},ó:function(){for(var i=0;i<this.µÿÂ;i++){for(var ýþË=0;ýþË<this.ø;ýþË++){this.Ïµá(i,ýþË).innerHTML='<img class="bottom" src="./img/1/'+this.Êþí[i][ýþË]+'.gif" />';}}},ùÖÞ:function(øð){øð.stop();$('xipai').blur();if(this.Ýö()==Ùõ.ê||this.Ýö()==Ùõ.óïâ){return;}this.Îü();},Îü:function(){this.ËÚô++;$('xipaiCount').innerHTML=this.ËÚô+'次';this.Éüí();this.ó();},Éüí:function(){var Å=[];for(var i=0;i<this.µÿÂ;i++){for(var ýþË=0;ýþË<this.ø;ýþË++){Å.push(this.Êþí[i][ýþË]);this.Êþí[i][ýþË]=null;}}for(var i=0;i<Å.length;i++){this.æ(Å[i]);}},û:function(á){var target=$(á.target);if(target.getTag()==='img'){if(this.Ýö()!=Ùõ.ÓõÝ){this.Ï();return;}target=target.parentNode;var ÖÖà=this.ßØ(target.id);var ÅÓÁ=ÖÖà[0];var À=ÖÖà[1];if(this.Êþí[ÅÓÁ][À]==0){if(this.Â){this.ïÕ();}return;}if(!this.Â){this.Á(ÅÓÁ,À);}else{if(this.Â[0]==ÅÓÁ&&this.Â[1]==À){this.ïÕ();}else{this.ªú(ÅÓÁ,À);this.ûùÎ.delay(100,this);}}}},ûùÎ:function(){var öøØ=this.Â[0];var íö=this.Â[1];var éõ=this.µØ[0];var åõü=this.µØ[1];ëØù.log('start find path from ['+öøØ+','+íö+'] to ['+éõ+','+åõü+']');var Øó=false;if(this.Êþí[öøØ][íö]!=this.Êþí[éõ][åõü]){this.ïÕ();this.ÓòÝ();}else{if(this.Ïñæ()){this.Ê();this.Æð();Øó=true;this.ÓÜ-=2;$('leftCount').innerHTML=this.ÓÜ/2+"对";if(this.ÓÜ<=0){this.Ë();alert('恭喜，您赢了！');this.Æó();}}else{this.ïÕ();this.ÓòÝ();}}ëØù.log('end path finded, isPathFind:'+Øó);},Ïñæ:function(){return this.Âï(this.Â,this.µØ);},Âï:function(ªïÇ,ü){var øí=new óãæ();var óí=[];var îìë={};îìë['row']=ªïÇ[0];îìë['column']=ªïÇ[1];îìë['turnCount']=0;îìë['baseRow']=îìë['row'];îìë['baseColumn']=îìë['column'];øí.âàÇ(îìë);óí.push(îìë);while(øí.Ç()!=0){var áê=øí.Ù();ÝéÌ:for(var i=0;i<4;i++){var ÅÓÁ=áê['row'];var À=áê['column'];if(i==0)ÅÓÁ-=1;else if(i==1)ÅÓÁ+=1;else if(i==2)À-=1;else if(i==3)À+=1;var ÙéÔ={};ÙéÔ['row']=ÅÓÁ;ÙéÔ['column']=À;ÙéÔ['turnCount']=áê['turnCount'];ÙéÔ['baseRow']=áê['baseRow'];ÙéÔ['baseColumn']=áê['baseColumn'];if(ÅÓÁ<=-2||ÅÓÁ>=(this.Êþí.length+1)||À<=-2||À>=(this.Êþí[0].length+1)){continue;}if(ÅÓÁ==áê['baseRow']||À==áê['baseColumn']){}else{ÙéÔ['turnCount']+=1;ÙéÔ['baseRow']=áê['row'];ÙéÔ['baseColumn']=áê['column'];}if(ÙéÔ['turnCount']>=3){continue;}for(var ýþË=0;ýþË<óí.length;ýþË++){var Ïè=óí[ýþË];if(Ïè['row']==ÅÓÁ&&Ïè['column']==À){if(ÙéÔ['turnCount']<Ïè['turnCount']){Ïè['turnCount']=ÙéÔ['turnCount'];Ïè['baseRow']=ÙéÔ['baseRow'];Ïè['baseColumn']=ÙéÔ['baseColumn'];øí.âàÇ(Ïè);continue ÝéÌ;}else if(ÙéÔ['turnCount']==Ïè['turnCount']){if(ÙéÔ['baseRow']==Ïè['baseRow']&&ÙéÔ['baseColumn']==Ïè['baseColumn']){continue ÝéÌ;}else{continue;}}else{continue ÝéÌ;}}}if(ÅÓÁ<=-1||ÅÓÁ>=this.Êþí.length||À<=-1||À>=this.Êþí[0].length){øí.âàÇ(ÙéÔ);óí.push(ÙéÔ);continue;}if(this.Êþí[ÅÓÁ][À]!=0){if(this.Êþí[ÅÓÁ][À]==this.Êþí[ªïÇ[0]][ªïÇ[1]]){if(ü){if(ü[0]==ÅÓÁ&&ü[1]==À){return true;}else{ÙéÔ['turnCount']=-1;continue;}}else{return ÙéÔ;}}else{ÙéÔ['turnCount']=-1;continue;}}else{øí.âàÇ(ÙéÔ);óí.push(ÙéÔ);}}}},ªú:function(ÅÓÁ,À){this.µØ=[];this.µØ[0]=ÅÓÁ;this.µØ[1]=À;var Ëç=this.Êþí[ÅÓÁ][À];this.Ïµá(ÅÓÁ,À).firstChild.src='./img/1/'+Ëç+'_over.gif';},ÓòÝ:function(){var ÅÓÁ=this.µØ[0];var À=this.µØ[1];var Ëç=this.Êþí[ÅÓÁ][À];this.Ïµá(ÅÓÁ,À).firstChild.src='./img/1/'+Ëç+'.gif';this.µØ=null;},Æð:function(){var ÅÓÁ=this.µØ[0];var À=this.µØ[1];this.Êþí[ÅÓÁ][À]=0;this.Ïµá(ÅÓÁ,À).firstChild.src='./img/1/0.gif';this.µØ=null;},Á:function(ÅÓÁ,À){this.Â=[];this.Â[0]=ÅÓÁ;this.Â[1]=À;var Ëç=this.Êþí[ÅÓÁ][À];this.Ïµá(ÅÓÁ,À).firstChild.src='./img/1/'+Ëç+'_over.gif';},ïÕ:function(){var ÅÓÁ=this.Â[0];var À=this.Â[1];var Ëç=this.Êþí[ÅÓÁ][À];this.Ïµá(ÅÓÁ,À).firstChild.src='./img/1/'+Ëç+'.gif';this.Â=null;},Ê:function(){var ÅÓÁ=this.Â[0];var À=this.Â[1];this.Êþí[ÅÓÁ][À]=0;this.Ïµá(ÅÓÁ,À).firstChild.src='./img/1/0.gif';this.Â=null;},empty:function(){;}});new ÝÝÐ();